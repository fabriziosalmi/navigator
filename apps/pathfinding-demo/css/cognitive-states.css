/**
 * cognitive-states.css
 * 
 * Visual adaptations based on detected cognitive state.
 * Applied to #layer-system container via .state-* classes.
 * 
 * States:
 * - .state-frustrated: Slower, calmer animations, more forgiving
 * - .state-concentrated: Faster, snappier, minimal distractions
 * - .state-exploring: Normal speed, all features visible
 * - .state-learning: Slightly slower, helpful hints
 * - .state-neutral: Default behavior
 */

/* ========================================
   FRUSTRATED STATE
   ========================================
   User is struggling - slow down, increase forgiveness
   ======================================== */

#layer-system.state-frustrated {
    /* Slower transitions (set via JS variable) */
    --transition-duration: 900ms; /* 600ms * 1.5 */
}

#layer-system.state-frustrated .card {
    /* Larger hit areas */
    padding: 1.5rem;
}

#layer-system.state-frustrated .card-blur-overlay {
    /* More prominent borders to show feedback */
    border-width: 3px;
    border-color: rgba(255, 100, 100, 0.4);
}

#layer-system.state-frustrated .gesture-hint {
    /* Show helpful hints */
    display: block !important;
    opacity: 0.9;
    animation: gentle-pulse 2s ease-in-out infinite;
}

@keyframes gentle-pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

/* Calmer hover effects */
#layer-system.state-frustrated .card:hover {
    transform: scale(1.03) !important; /* Less aggressive */
    transition-duration: 600ms !important; /* Slower */
}

/* ========================================
   CONCENTRATED STATE
   ========================================
   User is in flow - speed up, minimize distractions
   ======================================== */

#layer-system.state-concentrated {
    /* Faster transitions (set via JS variable) */
    --transition-duration: 360ms; /* 600ms * 0.6 */
}

#layer-system.state-concentrated .card {
    /* Snappier transforms */
    transition-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1);
}

#layer-system.state-concentrated .card-blur-overlay {
    /* Minimal decoration */
    opacity: 0.4;
    border-width: 1px;
}

#layer-system.state-concentrated .gesture-hint,
#layer-system.state-concentrated .tutorial-overlay {
    /* Hide distractions */
    display: none !important;
}

/* Snappier hover effects */
#layer-system.state-concentrated .card:hover {
    transform: scale(1.08) !important;
    transition-duration: 200ms !important;
}

/* Subtle focus indicator only */
#layer-system.state-concentrated .card.active::after {
    content: '';
    position: absolute;
    inset: 0;
    border: 2px solid rgba(100, 200, 255, 0.6);
    border-radius: 12px;
    pointer-events: none;
}

/* ========================================
   EXPLORING STATE
   ========================================
   User is discovering - show all features, normal speed
   ======================================== */

#layer-system.state-exploring {
    /* Normal transitions */
    --transition-duration: 600ms;
}

#layer-system.state-exploring .advanced-feature {
    /* Show experimental/advanced features */
    display: block !important;
    opacity: 1;
}

#layer-system.state-exploring .feature-tooltip {
    /* Show contextual help */
    opacity: 1;
    pointer-events: auto;
}

#layer-system.state-exploring .card-category-label {
    /* Prominent category labels */
    font-size: 1.1rem;
    opacity: 1;
}

/* Permissive visual feedback */
#layer-system.state-exploring .card-blur-overlay {
    border-color: rgba(100, 255, 150, 0.3);
    border-width: 2px;
}

/* ========================================
   LEARNING STATE
   ========================================
   User is improving - clear feedback, slight slowdown
   ======================================== */

#layer-system.state-learning {
    /* Slightly slower transitions */
    --transition-duration: 720ms; /* 600ms * 1.2 */
}

#layer-system.state-learning .progress-indicator {
    /* Show progress/achievement hints */
    display: block !important;
    opacity: 1;
}

#layer-system.state-learning .card.active {
    /* Clear visual feedback on active card */
    box-shadow: 0 0 20px rgba(100, 200, 255, 0.5);
}

#layer-system.state-learning .gesture-hint {
    /* Educational hints */
    display: block !important;
    opacity: 0.7;
    background: rgba(100, 200, 255, 0.1);
    border: 1px solid rgba(100, 200, 255, 0.3);
    padding: 0.5rem;
    border-radius: 8px;
}

/* Positive reinforcement on successful actions */
#layer-system.state-learning .card.transitioning {
    animation: learning-success 0.4s ease-out;
}

@keyframes learning-success {
    0% { transform: scale(1); }
    50% { 
        transform: scale(1.05);
        box-shadow: 0 0 30px rgba(100, 255, 150, 0.6);
    }
    100% { transform: scale(1); }
}

/* ========================================
   NEUTRAL STATE
   ========================================
   Default behavior
   ======================================== */

#layer-system.state-neutral {
    /* Normal transitions */
    --transition-duration: 600ms;
}

/* ========================================
   CROSS-STATE UTILITIES
   ========================================
   Shared helpers for all states
   ======================================== */

/* Gesture hints (hidden by default, shown in specific states) */
.gesture-hint {
    display: none;
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.9rem;
    z-index: 100;
}

/* Progress indicator (learning state) */
.progress-indicator {
    display: none;
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: rgba(100, 200, 255, 0.2);
    border: 1px solid rgba(100, 200, 255, 0.4);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.9rem;
    z-index: 100;
}

/* Feature tooltips (exploring state) */
.feature-tooltip {
    opacity: 0;
    pointer-events: none;
    position: absolute;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 0.5rem 0.75rem;
    border-radius: 6px;
    font-size: 0.85rem;
    white-space: nowrap;
    z-index: 200;
    transition: opacity 0.3s ease;
}

/* Advanced features (exploring state) */
.advanced-feature {
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

/* ========================================
   ACCESSIBILITY
   ========================================
   Maintain WCAG compliance across states
   ======================================== */

/* Ensure focus indicators are always visible */
#layer-system .card:focus-visible {
    outline: 3px solid rgba(100, 200, 255, 1) !important;
    outline-offset: 4px !important;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    #layer-system.state-frustrated .card-blur-overlay {
        border-width: 4px;
        border-color: rgba(255, 100, 100, 1);
    }

    #layer-system.state-concentrated .card.active::after {
        border-width: 3px;
        border-color: rgba(100, 200, 255, 1);
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    #layer-system.state-frustrated,
    #layer-system.state-concentrated,
    #layer-system.state-exploring,
    #layer-system.state-learning,
    #layer-system.state-neutral {
        --transition-duration: 0ms !important;
    }

    .gesture-hint,
    .card.transitioning {
        animation: none !important;
    }
}

/* ========================================
   RESPONSIVE ADJUSTMENTS
   ========================================
   Adapt to different screen sizes
   ======================================== */

@media (max-width: 768px) {
    /* Larger touch targets on mobile for frustrated state */
    #layer-system.state-frustrated .card {
        padding: 2rem;
        min-height: 200px;
    }

    /* Smaller hints on mobile */
    .gesture-hint {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
    }
}

@media (max-width: 480px) {
    /* Hide some hints on very small screens */
    #layer-system.state-exploring .feature-tooltip {
        display: none;
    }
}
