{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://navigator.app/config.schema.json",
  "title": "Navigator Configuration Schema",
  "description": "JSON Schema for validating Navigator's config.yaml",
  "type": "object",
  "required": ["plugins", "navigation", "ui"],
  "properties": {
    "plugins": {
      "type": "array",
      "description": "List of plugins to load and initialize (order matters)",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["name", "enabled"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Plugin class name (must match js/plugins/ structure)",
            "enum": [
              "GestureInputPlugin",
              "KeyboardInputPlugin",
              "VoiceInputPlugin",
              "NavigationLogicPlugin",
              "DomRendererPlugin",
              "AudioFeedbackPlugin",
              "VisualEffectsPlugin"
            ]
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether to load and initialize this plugin"
          },
          "priority": {
            "type": "integer",
            "description": "Plugin initialization priority (higher = earlier)",
            "minimum": 0,
            "maximum": 100,
            "default": 50
          },
          "options": {
            "type": "object",
            "description": "Plugin-specific configuration options",
            "properties": {
              "camera": {
                "type": "object",
                "description": "Camera configuration (for GestureInputPlugin)",
                "properties": {
                  "width": { "type": "integer", "minimum": 320, "maximum": 1920, "default": 640 },
                  "height": { "type": "integer", "minimum": 240, "maximum": 1080, "default": 480 },
                  "facing_mode": { "type": "string", "enum": ["user", "environment"], "default": "user" },
                  "frame_rate": { "type": "integer", "minimum": 15, "maximum": 60, "default": 30 },
                  "max_num_hands": { "type": "integer", "minimum": 1, "maximum": 2, "default": 1 },
                  "model_complexity": { "type": "integer", "enum": [0, 1], "default": 1 },
                  "min_detection_confidence": { "type": "number", "minimum": 0.3, "maximum": 0.95, "default": 0.7 },
                  "min_tracking_confidence": { "type": "number", "minimum": 0.3, "maximum": 0.95, "default": 0.5 }
                }
              },
              "gestures": {
                "type": "object",
                "description": "Gesture recognition configuration",
                "properties": {
                  "swipe": {
                    "type": "object",
                    "properties": {
                      "min_distance": { "type": "number", "minimum": 0.01, "maximum": 0.5, "default": 0.08 },
                      "max_time_ms": { "type": "integer", "minimum": 100, "maximum": 2000, "default": 800 },
                      "cooldown_ms": { "type": "integer", "minimum": 0, "maximum": 1000, "default": 300 }
                    }
                  },
                  "point": {
                    "type": "object",
                    "properties": {
                      "hold_duration_ms": { "type": "integer", "minimum": 500, "maximum": 5000, "default": 2000 },
                      "stability_threshold": { "type": "number", "minimum": 0.001, "maximum": 0.1, "default": 0.02 }
                    }
                  },
                  "fist": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean", "default": true },
                      "min_confidence": { "type": "number", "minimum": 0.5, "maximum": 0.99, "default": 0.75 }
                    }
                  },
                  "pinch": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean", "default": true },
                      "max_distance": { "type": "number", "minimum": 0.01, "maximum": 0.15, "default": 0.05 }
                    }
                  },
                  "grid_lock": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean", "default": true },
                      "cell_size": { "type": "number", "minimum": 0.05, "maximum": 0.5, "default": 0.15 },
                      "accumulator_decay": { "type": "number", "minimum": 0.5, "maximum": 0.99, "default": 0.85 },
                      "intent_threshold": { "type": "number", "minimum": 0.1, "maximum": 0.8, "default": 0.3 },
                      "dead_zone": { "type": "number", "minimum": 0.0, "maximum": 0.2, "default": 0.05 }
                    }
                  },
                  "predictive": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean", "default": true },
                      "smooth_factor": { "type": "number", "minimum": 0.0, "maximum": 1.0, "default": 0.7 },
                      "prediction_frames": { "type": "integer", "minimum": 1, "maximum": 10, "default": 3 }
                    }
                  }
                }
              },
              "audio": {
                "type": "object",
                "description": "Audio feedback configuration (for AudioFeedbackPlugin)",
                "properties": {
                  "master_volume": { "type": "number", "minimum": 0.0, "maximum": 1.0, "default": 0.3 },
                  "volumes": {
                    "type": "object",
                    "properties": {
                      "navigation": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
                      "success": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
                      "error": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
                      "ambient": { "type": "number", "minimum": 0.0, "maximum": 1.0 }
                    }
                  },
                  "spatial": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean" },
                      "pan_range": { "type": "number", "minimum": 0.0, "maximum": 1.0 }
                    }
                  }
                }
              },
              "visual_effects": {
                "type": "object",
                "description": "Visual effects configuration (for VisualEffectsPlugin)",
                "properties": {
                  "performance_mode": { "type": "string", "enum": ["low", "medium", "high"], "default": "medium" },
                  "particles": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean" },
                      "max_particles": { "type": "integer", "minimum": 10, "maximum": 1000 }
                    }
                  },
                  "light_beams": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean" },
                      "duration_ms": { "type": "integer", "minimum": 100, "maximum": 2000 }
                    }
                  },
                  "blur": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean" },
                      "inactive_cards_blur": { "type": "integer", "minimum": 0, "maximum": 50 },
                      "inactive_cards_brightness": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
                      "inactive_cards_saturation": { "type": "number", "minimum": 0.0, "maximum": 1.0 }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "performance": {
      "type": "object",
      "description": "Global performance settings",
      "properties": {
        "target_fps": { "type": "integer", "minimum": 30, "maximum": 120, "default": 60 },
        "fps_high_threshold": { "type": "integer", "minimum": 30, "maximum": 60 },
        "fps_medium_threshold": { "type": "integer", "minimum": 20, "maximum": 45 },
        "idle_timeout_ms": { "type": "integer", "minimum": 5000, "maximum": 60000, "default": 15000 },
        "idle_enabled": { "type": "boolean", "default": true },
        "lod": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "max_visible_cards": { "type": "integer", "minimum": 3, "maximum": 15, "default": 5 },
            "blur_distance_cards": { "type": "boolean", "default": true }
          }
        },
        "lazy_load_images": { "type": "boolean", "default": true },
        "lazy_load_threshold": { "type": "string", "pattern": "^\\d+(px|vh|vw)$", "default": "200px" }
      }
    },
    "navigation": {
      "type": "object",
      "description": "Navigation behavior configuration",
      "required": ["initial_layer"],
      "properties": {
        "cards": {
          "type": "object",
          "properties": {
            "transition_duration_ms": { "type": "integer", "minimum": 100, "maximum": 2000, "default": 600 },
            "ease_function": { "type": "string", "default": "cubic-bezier(0.4, 0, 0.2, 1)" },
            "active_scale": { "type": "number", "minimum": 0.5, "maximum": 2.0, "default": 1.0 },
            "side_cards_scale": { "type": "number", "minimum": 0.3, "maximum": 1.0, "default": 0.75 },
            "side_cards_opacity": { "type": "number", "minimum": 0.0, "maximum": 1.0, "default": 0.5 },
            "side_cards_rotation_deg": { "type": "integer", "minimum": 0, "maximum": 90, "default": 45 },
            "side_cards_offset_x": { "type": "integer", "default": 600 },
            "side_cards_offset_z": { "type": "integer", "default": -400 }
          }
        },
        "layers": {
          "type": "object",
          "properties": {
            "transition_duration_ms": { "type": "integer", "minimum": 200, "maximum": 2000, "default": 800 },
            "ease_function": { "type": "string", "default": "cubic-bezier(0.23, 1, 0.32, 1)" }
          }
        },
        "momentum": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "friction": { "type": "number", "minimum": 0.5, "maximum": 0.99, "default": 0.92 },
            "min_velocity": { "type": "number", "minimum": 0.001, "maximum": 0.1, "default": 0.01 },
            "velocity_multiplier": { "type": "number", "minimum": 0.1, "maximum": 2.0, "default": 0.5 }
          }
        },
        "initial_layer": { "type": "string", "default": "video" },
        "initial_card_index": { "type": "integer", "minimum": 0, "default": 0 }
      }
    },
    "adaptive": {
      "type": "object",
      "description": "Adaptive difficulty system",
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "levels": {
          "type": "object",
          "properties": {
            "starting_level": { "type": "integer", "minimum": 1, "maximum": 5, "default": 1 },
            "max_level": { "type": "integer", "minimum": 1, "maximum": 10, "default": 5 },
            "xp_per_level": { "type": "integer", "minimum": 50, "maximum": 500, "default": 100 }
          }
        }
      }
    },
    "ui": {
      "type": "object",
      "description": "User interface configuration",
      "required": ["hud"],
      "properties": {
        "hud": {
          "type": "object",
          "required": ["top_bar", "bottom_bar"],
          "properties": {
            "top_bar": { "type": "boolean", "default": true },
            "bottom_bar": { "type": "boolean", "default": true },
            "compact_mode": { "type": "boolean", "default": true }
          }
        },
        "update_frequency_ms": { "type": "integer", "minimum": 50, "maximum": 500, "default": 100 },
        "debug": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "show_fps": { "type": "boolean", "default": false },
            "show_gesture_data": { "type": "boolean", "default": false },
            "console_logging": { "type": "boolean", "default": true }
          }
        },
        "start_screen": {
          "type": "object",
          "properties": {
            "show_tutorial": { "type": "boolean", "default": true },
            "auto_start": { "type": "boolean", "default": false }
          }
        }
      }
    },
    "accessibility": {
      "type": "object",
      "description": "Accessibility options",
      "properties": {
        "respect_prefers_reduced_motion": { "type": "boolean", "default": true },
        "keyboard": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "arrows_navigate_cards": { "type": "boolean", "default": true },
            "page_up_down_layers": { "type": "boolean", "default": true }
          }
        },
        "voice": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "wake_word": { "type": "string", "default": "navigator" }
          }
        }
      }
    },
    "developer": {
      "type": "object",
      "description": "Developer options",
      "properties": {
        "hot_reload": { "type": "boolean", "default": false },
        "mock_gestures": { "type": "boolean", "default": false },
        "monitor_performance": { "type": "boolean", "default": true },
        "log_slow_frames": { "type": "boolean", "default": true },
        "show_error_overlay": { "type": "boolean", "default": true },
        "detailed_errors": { "type": "boolean", "default": true }
      }
    },
    "layers": {
      "type": "object",
      "description": "Content layer definitions",
      "patternProperties": {
        "^[a-z_]+$": {
          "type": "object",
          "required": ["label", "icon"],
          "properties": {
            "label": { "type": "string", "minLength": 1 },
            "icon": { "type": "string", "minLength": 1 },
            "cards": { "type": "integer", "minimum": 1, "default": 4 }
          }
        }
      }
    },
    "presets": {
      "type": "object",
      "description": "Quick configuration presets",
      "additionalProperties": {
        "type": "object"
      }
    },
    "active_preset": {
      "type": "string",
      "description": "Name of the active preset to apply",
      "enum": ["performance", "quality", "accessible", "precision", "development"]
    }
  },
  "additionalProperties": false
}
