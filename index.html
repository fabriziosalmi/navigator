<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigator</title>

    <!-- Content Security Policy - Strict Security -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'none';
        script-src 'self' https://cdn.jsdelivr.net 'wasm-unsafe-eval';
        style-src 'self' https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' https://images.unsplash.com data: blob:;
        media-src 'self' https://www.w3schools.com blob:;
        connect-src 'self' https://cdn.jsdelivr.net;
        worker-src 'self' blob:;
        manifest-src 'self';
        base-uri 'self';
        form-action 'none';
        object-src 'none';
        upgrade-insecure-requests;
    ">
    
    <!-- Modular CSS Architecture -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layers.css">
    <link rel="stylesheet" href="css/cards.css">
    <link rel="stylesheet" href="css/categories.css">
    <link rel="stylesheet" href="css/lod.css">
    <link rel="stylesheet" href="css/hud.css">
    <link rel="stylesheet" href="css/adaptive.css">
    <link rel="stylesheet" href="css/history.css">
    <link rel="stylesheet" href="css/gestures.css">
    <link rel="stylesheet" href="css/start-screen.css">
    <link rel="stylesheet" href="css/effects.css">
    <link rel="stylesheet" href="css/interface-hud.css">
    <link rel="stylesheet" href="css/unified-hud.css">
    <link rel="stylesheet" href="css/carousel-3d.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Start Screen -->
    <div id="start-screen">
        <div class="start-box">
            <h1>ğŸŒŒ Navigator</h1>
            <p>Multi-layer gesture-controlled interface</p>
            <p>Navigate through cards with hand gestures</p>
            <button id="start-btn">ğŸš€ Start Experience</button>
            <div class="permissions-info">
                ğŸ“¹ Camera permission will be requested<br>
                ğŸ”Š Audio will be enabled<br>
                ğŸ–ï¸ Use hand gestures to navigate
            </div>
        </div>
    </div>
    <!-- Layer Tabs - Hidden (functionality preserved in HUD) -->
    <div id="layer-tabs" class="hidden-element">
        <div class="layer-tab active" data-layer="video">
            <div class="icon">ğŸ¬</div>
            <div class="label">Videos</div>
        </div>
        <div class="layer-tab" data-layer="news">
            <div class="icon">ğŸ“°</div>
            <div class="label">News</div>
        </div>
        <div class="layer-tab" data-layer="images">
            <div class="icon">ğŸ–¼ï¸</div>
            <div class="label">Images</div>
        </div>
        <div class="layer-tab" data-layer="games">
            <div class="icon">ğŸ®</div>
            <div class="label">Games</div>
        </div>
        <div class="layer-tab" data-layer="apps">
            <div class="icon">ğŸ“±</div>
            <div class="label">Apps</div>
        </div>
        <div class="layer-tab" data-layer="settings">
            <div class="icon">âš™ï¸</div>
            <div class="label">Settings</div>
        </div>
    </div>

    <!-- Layer WOW Label - Hidden (integrated in HUD) -->
    <div id="layer-wow-label" class="hidden-element">
        <div class="wow-text">WOW</div>
        <div class="wow-layer-name">Videos</div>
        <div class="wow-icon">ğŸ¬</div>
    </div>    <!-- Dynamic Background Effects -->
    <div id="dynamic-background">
        <div class="bg-glow bg-glow-1"></div>
        <div class="bg-glow bg-glow-2"></div>
        <div class="bg-glow bg-glow-3"></div>
    </div>

    <!-- Particle effect canvases disabled for performance optimization -->
    <!-- <canvas id="light-trails-canvas"></canvas> -->
    <!-- <canvas id="data-streams-canvas"></canvas> -->
    <!-- <canvas id="light-beams-canvas"></canvas> -->

    <!-- Cards Viewport -->
    <div id="cards-viewport"></div>

    <!-- Snap Indicators - Hidden for modern UI -->
    <div class="snap-indicator left hidden-element">ğŸ‘ˆ</div>
    <div class="snap-indicator right hidden-element">ğŸ‘‰</div>

    <!-- Top HUD Bar - Interface Status & History -->
    <div class="top-hud-container">
        <!-- Interface Status HUD will be moved here by JS -->
        
        <!-- Navigation History -->
        <div class="top-navigation-history">
            <span class="history-title">Recent</span>
            <div class="history-icons" id="hud-history">
                <!-- Populated dynamically with last 5 navigation actions -->
            </div>
        </div>
        
        <!-- Gesture Status Panel -->
        <div class="gesture-status-panel">
            <div class="gesture-status-title">Gesture System</div>
            <div class="gesture-status-content">
                <div class="gesture-stat">
                    <span class="stat-label">Hand</span>
                    <span class="status-dot inactive" id="hand-status"></span>
                    <span class="stat-value" id="hand-state">Searching</span>
                </div>
                <div class="gesture-stat">
                    <span class="stat-label">Current</span>
                    <span class="stat-value" id="gesture-type">None</span>
                </div>
                <div class="gesture-stat">
                    <span class="stat-label">Grid Lock</span>
                    <span class="stat-value" id="grid-lock">Active</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Unified Bottom HUD - Quantum Leap Design -->
    <div id="quantum-hud">
        <!-- Gesture LED Indicator -->
        <div class="gesture-led" id="gesture-led"></div>
        
        <!-- Layer & Position Info -->
        <div class="hud-section position-info">
            <div class="layer-display">
                <span class="layer-name" id="hud-layer-name">Videos</span>
                <span class="layer-meta" id="hud-layer-meta">Layer 1/6</span>
            </div>
            <div class="card-position">
                <span class="current-card" id="hud-current-card">1</span>
                <span class="separator">/</span>
                <span class="total-cards" id="hud-total-cards">4</span>
            </div>
        </div>

        <!-- Central Navigation -->
        <div class="hud-section nav-controls">
            <button class="hud-nav" id="prev-btn" data-action="prev" title="Previous card">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M15 18l-6-6 6-6"/>
                </svg>
            </button>
            <button class="hud-nav" id="layer-up" data-action="layer-up" title="Layer up">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M12 19V5m0 0l-7 7m7-7l7 7"/>
                </svg>
            </button>
            <button class="hud-nav" id="layer-down" data-action="layer-down" title="Layer down">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M12 5v14m0 0l-7-7m7 7l7-7"/>
                </svg>
            </button>
            <button class="hud-nav" id="next-btn" data-action="next" title="Next card">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
            </button>
        </div>

        <!-- Adaptive Level Progress -->
        <div class="hud-section adaptive-display" id="adaptive-hud-quantum">
            <!-- Populated by AdaptiveNavigationHUD -->
        </div>

        <!-- Status & Metrics -->
        <div class="hud-section status-display">
            <div class="hand-status" id="hud-hand-status">
                <svg class="hand-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 11V6a1 1 0 0 1 2 0v5m0 0V5a1 1 0 0 1 2 0v6m0 0V4a1 1 0 0 1 2 0v7m0 0V5a1 1 0 0 1 2 0v8a5 5 0 0 1-10 0v-1"/>
                </svg>
                <span id="hud-hand-text">Searching</span>
            </div>
            
            <!-- Gesture Legend Compact -->
            <div class="gesture-legend-compact">
                <div class="legend-item" data-gesture="swipe" title="Swipe left/right to navigate cards">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </div>
                <div class="legend-item" data-gesture="point" title="Point 2s to focus card">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14m0 0l-7-7m7 7l7-7"/>
                    </svg>
                </div>
                <div class="legend-item locked" data-gesture="pinch" title="Pinch (unlock at Level 2)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M3 12h3m12 0h3M12 3v3m0 12v3"/>
                    </svg>
                </div>
            </div>
            
            <div class="debug-compact" id="hud-debug-ticker">
                <span class="ticker-text" id="hud-ticker-text"></span>
            </div>
        </div>
    </div>

    <!-- Layer WOW Label -->
    <div id="layer-wow-label" class="hidden-element">
        <div class="wow-text">WOW</div>
        <div class="wow-layer-name">Videos</div>
        <div class="wow-icon">ğŸ¬</div>
    </div>

    <!-- Gesture Info - Hidden (integrated in HUD) -->
    <div id="gesture-info" class="hidden-element">
        <h3>ğŸ–ï¸ Gestures</h3>
        <p><span class="status-dot inactive" id="hand-status"></span>Hand: <strong id="hand-state">Not detected</strong></p>
        <p>Gesture: <strong id="gesture-type">None</strong></p>
        <p>Grid Lock: <strong id="grid-lock">Active</strong></p>
    </div>

    <!-- GESTURE INDICATOR - Hidden (will integrate in HUD) -->
    <div id="gesture-indicator" class="hidden-element">
        <div class="gesture-hint" id="point-hint" data-gesture="point" title="Point to focus">
            <div class="gesture-icon">ğŸ‘†</div>
            <div class="gesture-label">Point<br><span class="gesture-context">2s = Focus</span></div>
        </div>
        <div class="gesture-hint" id="pinch-hint" data-gesture="pinch" title="Pinch to zoom/grab">
            <div class="gesture-icon">ğŸ¤</div>
            <div class="gesture-label">Pinch<br><span class="gesture-context">Zoom/Grab</span></div>
        </div>
        <div class="gesture-hint" id="fist-hint" data-gesture="fist" title="Fist to collapse">
            <div class="gesture-icon">âœŠ</div>
            <div class="gesture-label">Fist<br><span class="gesture-context">Collapse</span></div>
        </div>
        <div class="gesture-hint" id="open-hint" data-gesture="open" title="Open hand to explode">
            <div class="gesture-icon">ğŸ–ï¸</div>
            <div class="gesture-label">Open<br><span class="gesture-context">Navigate/Reset</span></div>
        </div>
    </div>

    <!-- Debug History Panel -->
    <div id="debug-history">
        <h3>ğŸ” Debug History</h3>
        <div id="debug-log"></div>
    </div>

    <!-- Current Indicator -->
    <div id="current-indicator">
        <div id="current-layer-name">Videos</div>
        <div class="small-font opacity-70">
            Card <span id="current-card">1</span> / <span id="total-cards">4</span>
        </div>
    </div>

    <!-- Confirmation Overlay -->
    <div id="confirmation-overlay">
        <div class="confirmation-box">
            <h2 id="confirmation-title">Confirm Action</h2>
            <p id="confirmation-message">Are you sure?</p>
            <div class="confirmation-buttons">
                <button class="confirm-btn yes" id="confirm-yes">âœ“ YES</button>
                <button class="confirm-btn no" id="confirm-no">âœ— NO</button>
            </div>
            <div class="gesture-instructions">
                Use gestures:<br>
                <strong>ğŸ‘ Thumbs Up (1 sec) = YES</strong><br>
                <strong>â˜ï¸ Shake Index (3x) = NO</strong><br>
                or press <strong>Enter/Y</strong> for YES, <strong>Escape/N</strong> for NO
            </div>
            <div id="gesture-progress">
                <div id="thumbs-up-progress" class="hidden-element">
                    <div>ğŸ‘ Hold thumbs up...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="thumbs-progress-fill"></div>
                    </div>
                </div>
                <div id="shake-progress" class="hidden-element">
                    <div class="shake-counter">â˜ï¸ Shakes: <span id="shake-count">0</span> / 3</div>
                </div>
            </div>
        </div>
    </div>

    <video id="webcam" autoplay playsinline></video>

    <!-- MediaPipe Scripts with Subresource Integrity (SRI) -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"
            integrity="sha384-q1KhAZhJcJXr3zfC3Tz07pBqQSabwFIZhXlmlUAB8s0zk4ETWERkIKGBCFQ5Jc3e"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"
            integrity="sha384-W/7NVG2tfN12ld8faSFVOZ/W4UHFHze98GqEUPTl8EjY9QDwCKQIzoCHp8/IlIIr"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"
            integrity="sha384-oHwoZ9HyKv5ark5VOH+XWdbNfmhYtptAOBuV8plz6mAfXvTA6d8fULuYllWouEK2"
            crossorigin="anonymous"></script>

    <!-- Main initialization module -->
    <script type="module" src="./js/main-init.js"></script>
</body>
</html>
