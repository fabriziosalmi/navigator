# ============================================
# NAVIGATOR - CENTRALIZED CONFIGURATION V2
# ============================================
# Optimized plugin-based configuration with schema validation
# Schema: config.schema.json
# Version: 2.0.0 (Post Phase 3 Optimization)

# ============================================
# PLUGINS - Core & Plugin Architecture
# ============================================
# Plugins are loaded in priority order (higher = earlier)
# Each plugin can have specific options passed during initialization

plugins:
  # ===== INPUT PLUGINS (Priority: 100) =====

  - name: "GestureInputPlugin"
    enabled: true
    priority: 100
    options:
      # Camera configuration (consolidated from camera.* section)
      camera:
        width: 640
        height: 480
        facing_mode: "user"               # "user" (front) | "environment" (back)
        frame_rate: 30
        # MediaPipe Hands settings (consolidated from gestures.detection.*)
        max_num_hands: 1                  # 1-2 hands
        model_complexity: 1               # 0=lite, 1=full
        min_detection_confidence: 0.7     # 0.3-0.95 (higher = stricter)
        min_tracking_confidence: 0.5      # 0.3-0.95

      # Gesture recognition thresholds
      gestures:
        swipe:
          min_distance: 0.08              # Minimum hand movement (0-1 normalized)
          max_time_ms: 800                # Max time for valid swipe
          cooldown_ms: 300                # Cooldown between swipes

        point:
          hold_duration_ms: 2000          # Hold point for 2s to activate
          stability_threshold: 0.02       # Max movement while pointing

        fist:
          enabled: true
          min_confidence: 0.75

        open_hand:
          enabled: true
          finger_spread_threshold: 0.15

        pinch:
          enabled: true
          max_distance: 0.05              # Max thumb-index distance

        # Grid Lock System (gesture stabilization)
        grid_lock:
          enabled: true
          cell_size: 0.15                 # Grid cell size (0-1)
          accumulator_decay: 0.85         # Decay rate
          intent_threshold: 0.3           # Threshold to register intent
          dead_zone: 0.05                 # Central dead zone

        # Predictive tracking (compensate latency)
        predictive:
          enabled: true
          smooth_factor: 0.7              # 0-1 (higher = smoother)
          prediction_frames: 3            # Frames to predict ahead

  - name: "KeyboardInputPlugin"
    enabled: true
    priority: 100
    options:
      arrows_navigate_cards: true
      wasd_navigate_cards: true
      page_up_down_layers: true
      space_toggle_pause: true

  - name: "VoiceInputPlugin"
    enabled: false                        # Disabled by default
    priority: 100
    options:
      wake_word: "navigator"
      language: "en-US"

  # ===== UI PLUGINS (Priority: 90) =====

  - name: "OnboardingPlugin"
    enabled: true
    priority: 90
    options:
      storage_key: "navigator_onboarding_completed"
      auto_start: true

  # ===== SYSTEM PLUGINS (Priority: 95) =====

  - name: "IdleSystemPlugin"
    enabled: true
    priority: 95
    options:
      idle_timeout_ms: 15000              # 15 seconds
      check_interval_ms: 1000             # Check every second

  # ===== LOGIC PLUGINS (Priority: 50) =====

  - name: "NavigationLogicPlugin"
    enabled: true
    priority: 50
    options:
      # Card navigation behavior
      cards:
        transition_duration_ms: 600
        ease_function: "cubic-bezier(0.4, 0, 0.2, 1)"
        # 3D Carousel settings
        active_scale: 1.0
        side_cards_scale: 0.75
        side_cards_opacity: 0.5
        side_cards_rotation_deg: 45
        side_cards_offset_x: 600
        side_cards_offset_z: -400

      # Layer navigation behavior
      layers:
        transition_duration_ms: 800
        ease_function: "cubic-bezier(0.23, 1, 0.32, 1)"

      # Momentum/inertia physics
      momentum:
        enabled: true
        friction: 0.92                    # 0.8-0.98 (higher = longer)
        min_velocity: 0.01
        velocity_multiplier: 0.5

      # Initial state
      initial_layer: "video"
      initial_card_index: 0

  # ===== OUTPUT PLUGINS (Priority: 10) =====

  - name: "DomRendererPlugin"
    enabled: true
    priority: 10
    options:
      # Level of Detail system
      lod:
        enabled: true
        max_visible_cards: 5              # Max cards in DOM
        blur_distance_cards: true

      # Performance optimizations
      lazy_load_images: true
      lazy_load_threshold: "200px"

  - name: "AudioFeedbackPlugin"
    enabled: true
    priority: 10
    options:
      master_volume: 0.3                  # 0.0-1.0

      # Individual sound volumes
      volumes:
        navigation: 0.4
        success: 0.5
        error: 0.3
        ambient: 0.2

      # Spatial audio (stereo panning)
      spatial:
        enabled: true
        pan_range: 0.7                    # 0-1 (max stereo separation)

      # Audio event triggers
      feedback:
        card_select: true
        layer_change: true
        gesture_detect: true
        error_sound: true

  - name: "VisualEffectsPlugin"
    enabled: true
    priority: 10
    options:
      performance_mode: "medium"          # low | medium | high

      # Particle systems
      particles:
        enabled: false                    # Performance: disabled
        max_particles: 100

      # Light beams (Akira-style)
      light_beams:
        enabled: false                    # Performance: disabled
        duration_ms: 600

      # Card blur overlay (active)
      blur:
        enabled: true
        inactive_cards_blur: 12           # pixels
        inactive_cards_brightness: 0.6    # 0-1
        inactive_cards_saturation: 0.3    # 0-1

      # Gesture LED indicator
      gesture_led:
        enabled: true
        pulse_duration_ms: 300
        colors:
          idle: "#333333"
          detecting: "#00ffff"
          success: "#00ff00"
          error: "#ff0000"

# ============================================
# GLOBAL SETTINGS
# ============================================

# Performance & optimization
performance:
  target_fps: 60                          # 30-120
  fps_high_threshold: 50                  # Switch to medium mode below this
  fps_medium_threshold: 30                # Switch to low mode below this

  # Idle detection
  idle_timeout_ms: 15000                  # 15 seconds
  idle_enabled: true

# Adaptive difficulty system
adaptive:
  enabled: true
  levels:
    starting_level: 1
    max_level: 5
    xp_per_level: 100

    # XP rewards
    xp_swipe_success: 10
    xp_layer_change: 15
    xp_gesture_combo: 25
    xp_precision_bonus: 5

  # Difficulty scaling per level
  difficulty:
    level_1:
      gestures: ["swipe"]
      speed_multiplier: 0.8
    level_2:
      gestures: ["swipe", "pinch"]
      speed_multiplier: 0.9
    level_3:
      gestures: ["swipe", "pinch", "fist", "open_hand"]
      speed_multiplier: 1.0
    level_4:
      gestures: ["swipe", "pinch", "fist", "open_hand", "point"]
      speed_multiplier: 1.1
    level_5:
      gestures: ["all"]
      speed_multiplier: 1.2

# User interface
ui:
  hud:
    top_bar: true
    bottom_bar: true
    compact_mode: true

  update_frequency_ms: 100

  debug:
    enabled: false
    show_fps: false
    show_gesture_data: false
    console_logging: true

  start_screen:
    show_tutorial: true
    auto_start: false

# Accessibility
accessibility:
  respect_prefers_reduced_motion: true
  keyboard:
    enabled: true
    arrows_navigate_cards: true
    page_up_down_layers: true
  voice:
    enabled: false
    wake_word: "navigator"

# Developer options
developer:
  hot_reload: false
  mock_gestures: false
  monitor_performance: true
  log_slow_frames: true
  show_error_overlay: true
  detailed_errors: true

# ============================================
# CONTENT LAYERS
# ============================================
layers:
  video:
    label: "Videos"
    icon: "üé¨"
    cards: 4
  news:
    label: "News"
    icon: "üì∞"
    cards: 4
  images:
    label: "Images"
    icon: "üñºÔ∏è"
    cards: 4
  games:
    label: "Games"
    icon: "üéÆ"
    cards: 4
  apps:
    label: "Apps"
    icon: "üì±"
    cards: 4
  settings:
    label: "Settings"
    icon: "‚öôÔ∏è"
    cards: 4

# ============================================
# CONFIGURATION PRESETS
# ============================================
# Quick preset configurations for different use cases

presets:
  # Maximum performance (minimal effects)
  performance:
    performance.target_fps: 60
    plugins:
      - name: "VisualEffectsPlugin"
        options:
          performance_mode: "low"
          particles.enabled: false
          light_beams.enabled: false
      - name: "NavigationLogicPlugin"
        options:
          momentum.enabled: false

  # Maximum quality (all effects enabled)
  quality:
    performance.target_fps: 60
    plugins:
      - name: "VisualEffectsPlugin"
        options:
          performance_mode: "high"
          particles.enabled: true
          light_beams.enabled: true

  # Accessibility focused (easier gestures, slower animations)
  accessible:
    plugins:
      - name: "GestureInputPlugin"
        options:
          gestures:
            swipe:
              min_distance: 0.06          # Easier swipes
              cooldown_ms: 500            # More time
      - name: "NavigationLogicPlugin"
        options:
          cards:
            transition_duration_ms: 800   # Slower animations

  # Precision focused (demos/testing)
  precision:
    plugins:
      - name: "GestureInputPlugin"
        options:
          camera:
            min_detection_confidence: 0.8
          gestures:
            swipe:
              min_distance: 0.12          # Longer swipes required
            grid_lock:
              cell_size: 0.1              # Smaller grid
              intent_threshold: 0.4       # Higher threshold

  # Development mode (all debug features)
  development:
    ui:
      debug:
        enabled: true
        show_fps: true
        show_gesture_data: true
      start_screen:
        auto_start: true
    developer:
      monitor_performance: true

# ============================================
# ACTIVE PRESET
# ============================================
# Uncomment to activate a preset (overrides above settings)
# active_preset: "performance"
# active_preset: "quality"
# active_preset: "accessible"
active_preset: "precision"
# active_preset: "development"
